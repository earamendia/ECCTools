<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bilateral Trade Assumption • ECCTools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Bilateral Trade Assumption">
<meta property="og:description" content="ECCTools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ECCTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ECCTools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/balancing_matrix.html">Using the balancing matrix</a>
    </li>
    <li>
      <a href="../articles/transform_to_bta.html">Bilateral Trade Assumption</a>
    </li>
    <li>
      <a href="../articles/transform_to_dta.html">Domestic Technology Assumption</a>
    </li>
    <li>
      <a href="../articles/transform_to_gma.html">Global Market Assumption</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="transform_to_bta_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Bilateral Trade Assumption</h1>
            
      
      
      <div class="hidden name"><code>transform_to_bta.Rmd</code></div>

    </div>

    
    
<p>In this vignette we explain how the Bilateral Trade Assumption can be formulated from a <code>.tidy_iea_df</code>.</p>
<div id="the-bilateral-trade-assumption" class="section level2">
<h2 class="hasAnchor">
<a href="#the-bilateral-trade-assumption" class="anchor"></a>The Bilateral Trade Assumption</h2>
<p>The Bilateral Trade Assumption (BTA) enables the analyst to construct the Multi-Regional Physical Supply Use Table (MR-PSUT) framework by providing bilateral trade data linking regions. An excellent example of MR-PSUT constructed following a BTA for agricultural products can be found in <span class="citation">@bruckner_fabio</span> .</p>
<p>The BTA is therefore the assumption closest to reality, as it seeks to describe each bilateral energy carrier flow from one country to another. The only drawback is that it requires input data representing bilateral flows between countries or regions, which may be hard to find, or which may require significant data preparation time.</p>
</div>
<div id="formulating-the-bilateral-trade-assumption" class="section level2">
<h2 class="hasAnchor">
<a href="#formulating-the-bilateral-trade-assumption" class="anchor"></a>Formulating the Bilateral Trade Assumption</h2>
<p>To formulate the BTA, one needs to:</p>
<ul>
<li>Prepare bilateral trade data</li>
<li>Call the <code>IEATools::add_psut_matnames')</code> to add a matrix name column.</li>
<li>Call the <code><a href="../reference/convert_to_net_trade.html">convert_to_net_trade()</a></code>, which converts trade data to net trade. See “Possible issues” below.</li>
<li>Call the <code><a href="../reference/transform_to_bta.html">transform_to_bta()</a></code> function, and provide bilateral trade data as argument to the function.</li>
</ul>
<div id="preparing-bilateral-trade-data" class="section level3">
<h3 class="hasAnchor">
<a href="#preparing-bilateral-trade-data" class="anchor"></a>Preparing bilateral trade data</h3>
<p>The bilateral trade data needs to be provided as input to the <code><a href="../reference/transform_to_bta.html">transform_to_bta()</a></code> function in the following format:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">AB_world_btd</span> <span class="op">&lt;-</span> <span class="va">tidy_AB_data</span> <span class="op">%&gt;%</span> 
  <span class="fu">IEATools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/IEATools/man/add_psut_matnames.html">add_psut_matnames</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/calc_bilateral_trade_df_gma.html">calc_bilateral_trade_df_gma</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 8
## Columns: 8
## $ Provenience              &lt;chr&gt; "A", "A", "A", "A", "A", "A", "B", "B"
## $ Country                  &lt;chr&gt; "A", "B", "A", "B", "A", "B", "A", "B"
## $ Method                   &lt;chr&gt; "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PC…
## $ Energy.type              &lt;chr&gt; "E", "E", "E", "E", "E", "E", "E", "E"
## $ Last.stage               &lt;chr&gt; "Final", "Final", "Final", "Final", "Final", …
## $ Year                     &lt;dbl&gt; 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018
## $ Product                  &lt;chr&gt; "Coking coal", "Coking coal", "Crude oil", "C…
## $ Share_Exports_By_Product &lt;dbl&gt; 0, 1, 0, 1, 0, 1, 1, 0</code></pre>
<p>Here we have used the <code><a href="../reference/calc_bilateral_trade_df_gma.html">calc_bilateral_trade_df_gma()</a></code> function to pull the share of exports that would correspond to the Global Market Assumption, but the analyst can proceed in any way to turn the bilateral trade data in a data frame of the dimensions and features shown above.</p>
<p>Next step is to verify that the constructed bilateral trade data frame is valid. To check that the bilateral trade data that has been prepared is valid, one can use the <code><a href="../reference/check_bilateral_trade_df.html">check_bilateral_trade_df()</a></code> function. To be valid, both (1)~the sum of shares by product and by exporting country (“Provenience” column) should be equal to unity; and (2)~the sum of shares by product and by importing country (“Country” column) should be equal to unity.</p>
<p>For instance, the bilateral trade data that we have obtained using the <code><a href="../reference/calc_bilateral_trade_df_gma.html">calc_bilateral_trade_df_gma()</a></code> function is valid:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/check_bilateral_trade_df.html">check_bilateral_trade_df</a></span><span class="op">(</span><span class="va">AB_world_btd</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Conversely, if we filter out the second row, the bilateral trade data is not valid anymore:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">AB_world_btd</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span> <span class="op">(</span><span class="va">Product</span> <span class="op">==</span> <span class="st">"Coking coal"</span> <span class="op">&amp;</span> <span class="va">Share_Exports_By_Product</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/check_bilateral_trade_df.html">check_bilateral_trade_df</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## Error: The sum of shares by product and exporting country is not equal to 1.</code></pre>
<p><strong>Note</strong>: It is important to note that one doesn’t need to provide the bilateral trade data for all products. If some products are not covered in the bilateral trade data, then the Global Market Assumption will be used to do the trade linking process for missing products. But it is important that the products that are covered are fully covered (i.e. that all flows corresponding to all the regions included in the MR-PSUT are included in the bilateral trade data frame, for that given product).</p>
</div>
<div id="transforming-to-bilateral-trade-assumption" class="section level3">
<h3 class="hasAnchor">
<a href="#transforming-to-bilateral-trade-assumption" class="anchor"></a>Transforming to Bilateral Trade Assumption</h3>
<p>Once the bilateral trade data is prepared, and once it has been verified with the <code><a href="../reference/check_bilateral_trade_df.html">check_bilateral_trade_df()</a></code> function that the bilateral trade data is valid, one can call the <code><a href="../reference/transform_to_bta.html">transform_to_bta()</a></code> function as follows:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tidy_AB_data</span> <span class="op">%&gt;%</span> 
  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/add_row.html">add_row</a></span><span class="op">(</span>Country <span class="op">=</span> <span class="st">"B"</span>, Method <span class="op">=</span> <span class="st">"PCM"</span>, Energy.type <span class="op">=</span> <span class="st">"E"</span>, Last.stage <span class="op">=</span> <span class="st">"Final"</span>, Year <span class="op">=</span> <span class="fl">2018</span>, 
                  Ledger.side <span class="op">=</span> <span class="st">"Supply"</span>, Flow.aggregation.point <span class="op">=</span> <span class="st">"Total primary energy supply"</span>, 
                  Flow <span class="op">=</span> <span class="st">"Imports [of A very odd product]"</span>, Product <span class="op">=</span> <span class="st">"A very odd product"</span>, Unit <span class="op">=</span> <span class="st">"ktoe"</span>, E.dot <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">IEATools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/IEATools/man/add_psut_matnames.html">add_psut_matnames</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/convert_to_net_trade.html">convert_to_net_trade</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/transform_to_bta.html">transform_to_bta</a></span><span class="op">(</span>bilateral_trade_df <span class="op">=</span> <span class="va">AB_world_btd</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 94
## Columns: 12
## $ Country                &lt;chr&gt; "World", "World", "World", "World", "World", "W…
## $ Method                 &lt;chr&gt; "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM"…
## $ Energy.type            &lt;chr&gt; "E", "E", "E", "E", "E", "E", "E", "E", "E", "E…
## $ Last.stage             &lt;chr&gt; "Final", "Final", "Final", "Final", "Final", "F…
## $ Year                   &lt;dbl&gt; 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018,…
## $ Ledger.side            &lt;chr&gt; "Supply", "Supply", "Supply", "Supply", "Supply…
## $ Flow.aggregation.point &lt;chr&gt; "Total primary energy supply", "Total primary e…
## $ Flow                   &lt;chr&gt; "{A}_Resources [of Coking coal]", "{A}_Resource…
## $ Product                &lt;chr&gt; "{A}_Coking coal [from Resources]", "{A}_Crude …
## $ Unit                   &lt;chr&gt; "ktoe", "ktoe", "ktoe", "ktoe", "ktoe", "ktoe",…
## $ E.dot                  &lt;dbl&gt; 5000, 8500, 4000, 850, 5000, 400, 3200, 200, 85…
## $ matnames               &lt;chr&gt; "R", "R", "R", "V", "V", "V", "V", "V", "V", "V…</code></pre>
<p>Regarding the treatment of unbalances and potential issues that may appear while formulating the Bilateral Trade Assumption, it is recommended to read first the Global Market Assumption vignette.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Emmanuel Aramendia.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
