<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Global Market Assumption • ECCTools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Global Market Assumption">
<meta property="og:description" content="ECCTools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ECCTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ECCTools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/balancing_matrix.html">Using the balancing matrix</a>
    </li>
    <li>
      <a href="../articles/transform_to_bta.html">Bilateral Trade Assumption</a>
    </li>
    <li>
      <a href="../articles/transform_to_dta.html">Domestic Technology Assumption</a>
    </li>
    <li>
      <a href="../articles/transform_to_gma.html">Global Market Assumption</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="transform_to_gma_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Global Market Assumption</h1>
            
      
      
      <div class="hidden name"><code>transform_to_gma.Rmd</code></div>

    </div>

    
    
<p>In this vignette we explain how the Global Market Assumption can be formulated from a <code>.tidy_iea_df</code>.</p>
<div id="the-global-market-assumption" class="section level2">
<h2 class="hasAnchor">
<a href="#the-global-market-assumption" class="anchor"></a>The Global Market Assumption</h2>
<p>The Global Market Assumption assumes a global market for each traded product. For each product <span class="math inline">\(p\)</span>, the exporting share of each exporting country <span class="math inline">\(s\)</span> is determined as (see <span class="citation">@mr_psut_paper</span>):</p>
<p><span class="math display">\[c_{s,p} = \frac{x_{s,p}}{x_p}\]</span></p>
<p>where:</p>
<ul>
<li>
<span class="math inline">\(c_{s,p}\)</span> refers to the global share of exports of product <span class="math inline">\(p\)</span> by country <span class="math inline">\(s\)</span>;</li>
<li>
<span class="math inline">\(x_{s,p}\)</span> refers to the exports of product <span class="math inline">\(p\)</span> by country <span class="math inline">\(s\)</span>;</li>
<li>
<span class="math inline">\(x_p\)</span> refers to the global exports of product <span class="math inline">\(p\)</span>.</li>
</ul>
<p>We note that:</p>
<p><span class="math display">\[\sum_{s \in \mathcal{S}} c_{s,p} = 1\]</span></p>
<p>where <span class="math inline">\(\mathcal{S}\)</span> stands for the set of countries considered.</p>
<p>Hence, each country importing a product <span class="math inline">\(p\)</span> will import the share <span class="math inline">\(c_{s,p}\)</span> of its imports of product <span class="math inline">\(p\)</span> from country <span class="math inline">\(s\)</span>.</p>
<p>The Global Market Assumption is therefore a simplifying assumption which enables to:</p>
<ul>
<li>Run a quick, explorative, or demonstrative analysis, when there is no need for the precision bilateral trade data can provide;</li>
<li>Conduct analysis when bilateral trade data are not available, or are not of sufficient quality.</li>
</ul>
</div>
<div id="formulating-the-global-market-assumption" class="section level2">
<h2 class="hasAnchor">
<a href="#formulating-the-global-market-assumption" class="anchor"></a>Formulating the Global Market Assumption</h2>
<p>To formulate the Global Market Assumption, one simply needs to:</p>
<ul>
<li>Call the <code>IEATools::add_psut_matnames')</code> to add a matrix name column.</li>
<li>Call the <code><a href="../reference/convert_to_net_trade.html">convert_to_net_trade()</a></code>, which converts trade data to net trade. See “Possible issues” below.</li>
<li>Call the <code><a href="../reference/transform_to_gma.html">transform_to_gma()</a></code> function.</li>
</ul>
<p>Let’s see the example with the AB world example:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tidy_AB_data_gma</span> <span class="op">&lt;-</span> <span class="va">tidy_AB_data</span> <span class="op">%&gt;%</span> 
  <span class="fu">IEATools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/IEATools/man/add_psut_matnames.html">add_psut_matnames</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/convert_to_net_trade.html">convert_to_net_trade</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/transform_to_gma.html">transform_to_gma</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 94
## Columns: 12
## $ Country                &lt;chr&gt; "World", "World", "World", "World", "World", "W…
## $ Method                 &lt;chr&gt; "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM"…
## $ Energy.type            &lt;chr&gt; "E", "E", "E", "E", "E", "E", "E", "E", "E", "E…
## $ Last.stage             &lt;chr&gt; "Final", "Final", "Final", "Final", "Final", "F…
## $ Year                   &lt;dbl&gt; 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018,…
## $ Ledger.side            &lt;chr&gt; "Supply", "Supply", "Supply", "Supply", "Supply…
## $ Flow.aggregation.point &lt;chr&gt; "Total primary energy supply", "Total primary e…
## $ Flow                   &lt;chr&gt; "{A}_Resources [of Coking coal]", "{A}_Resource…
## $ Product                &lt;chr&gt; "{A}_Coking coal [from Resources]", "{A}_Crude …
## $ Unit                   &lt;chr&gt; "ktoe", "ktoe", "ktoe", "ktoe", "ktoe", "ktoe",…
## $ E.dot                  &lt;dbl&gt; 5000, 8500, 4000, 850, 5000, 400, 3200, 200, 85…
## $ matnames               &lt;chr&gt; "R", "R", "R", "V", "V", "V", "V", "V", "V", "V…</code></pre>
<p>The locations of each flow is now noted with the prefix "{Country}_" in the “Flow” column, and so is the location of origin of a given product in the “Product” column.</p>
<div id="unbalances" class="section level3">
<h3 class="hasAnchor">
<a href="#unbalances" class="anchor"></a>Unbalances</h3>
<p>Now, unbalanced: Balanced!??</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tidy_AB_data_gma</span> <span class="op">%&gt;%</span> 
  <span class="fu">IEATools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/IEATools/man/tidy_iea_df_balanced.html">tidy_iea_df_balanced</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="possible-issues" class="section level3">
<h3 class="hasAnchor">
<a href="#possible-issues" class="anchor"></a>Possible issues</h3>
<p>Two possible issues are worth noting here; first, the issue of an imported product not being produced anywhere, and second, the issue of a country both importing and exporting a given product. We note that these issues will also cause issues when applying the Bilateral Trade Assumption, and hence should be avoided prior to running the <code><a href="../reference/transform_to_gma.html">transform_to_gma()</a></code> function.</p>
<div id="imported-product-not-produced-anywhere" class="section level4">
<h4 class="hasAnchor">
<a href="#imported-product-not-produced-anywhere" class="anchor"></a>Imported product not produced anywhere</h4>
<p>A potential inconsistency in IEA data is the case of a country importing a product <span class="math inline">\(p\)</span> which is not produced anywhere else. Let us show an example with the AB world. Say that country B also imports “A very odd product”, but that country A does not produce it (and hence, doesn’t export it).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tidy_AB_data</span> <span class="op">%&gt;%</span> 
  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/add_row.html">add_row</a></span><span class="op">(</span>Country <span class="op">=</span> <span class="st">"B"</span>, Method <span class="op">=</span> <span class="st">"PCM"</span>, Energy.type <span class="op">=</span> <span class="st">"E"</span>, Last.stage <span class="op">=</span> <span class="st">"Final"</span>, Year <span class="op">=</span> <span class="fl">2018</span>, 
                  Ledger.side <span class="op">=</span> <span class="st">"Supply"</span>, Flow.aggregation.point <span class="op">=</span> <span class="st">"Total primary energy supply"</span>, 
                  Flow <span class="op">=</span> <span class="st">"Imports [of A very odd product]"</span>, Product <span class="op">=</span> <span class="st">"A very odd product"</span>, Unit <span class="op">=</span> <span class="st">"ktoe"</span>, E.dot <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">IEATools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/IEATools/man/add_psut_matnames.html">add_psut_matnames</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/convert_to_net_trade.html">convert_to_net_trade</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/transform_to_gma.html">transform_to_gma</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 94
## Columns: 12
## $ Country                &lt;chr&gt; "World", "World", "World", "World", "World", "W…
## $ Method                 &lt;chr&gt; "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM"…
## $ Energy.type            &lt;chr&gt; "E", "E", "E", "E", "E", "E", "E", "E", "E", "E…
## $ Last.stage             &lt;chr&gt; "Final", "Final", "Final", "Final", "Final", "F…
## $ Year                   &lt;dbl&gt; 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018,…
## $ Ledger.side            &lt;chr&gt; "Supply", "Supply", "Supply", "Supply", "Supply…
## $ Flow.aggregation.point &lt;chr&gt; "Total primary energy supply", "Total primary e…
## $ Flow                   &lt;chr&gt; "{A}_Resources [of Coking coal]", "{A}_Resource…
## $ Product                &lt;chr&gt; "{A}_Coking coal [from Resources]", "{A}_Crude …
## $ Unit                   &lt;chr&gt; "ktoe", "ktoe", "ktoe", "ktoe", "ktoe", "ktoe",…
## $ E.dot                  &lt;dbl&gt; 5000, 8500, 4000, 850, 5000, 400, 3200, 200, 85…
## $ matnames               &lt;chr&gt; "R", "R", "R", "V", "V", "V", "V", "V", "V", "V…</code></pre>
<p>As expected, the code above returns an error.</p>
<p><strong>Note</strong>: In the case where a product <span class="math inline">\(p\)</span> is imported by a given country but (1) is not exported by any other country, and (2) is produced by some other countries, we determine and apply the global production shares, instead of exports shares. This is an approximate way to deal with IEA data inconsistencies.</p>
</div>
<div id="country-both-importing-and-exporting-a-product" class="section level4">
<h4 class="hasAnchor">
<a href="#country-both-importing-and-exporting-a-product" class="anchor"></a>Country both importing and exporting a product</h4>
<p>The <code><a href="../reference/transform_to_gma.html">transform_to_gma()</a></code> function is not able to deal properly with a region that both imports and exports a given product. In other words, the data provided as input to the function needs to be described in net trade terms: either a product is imported, or is exported, by a given region.</p>
<p>The case of having a region that both imports and exports a given product may however happen for two reasons:</p>
<ol style="list-style-type: decimal">
<li>The data as reported by the IEA presents this feature. This may be an appropriate description of physical flows for instance in the case of a country exporting a product at a given time, and importing the same product in another time. Think of electricity, which production (and imports and exports) may vary considerably depending on the weather conditions.</li>
<li>The analyst has aggregated countries to construct bigger regions, for instance EU countries have been aggregated in a single EU region. In that case, as some countries import a given product <span class="math inline">\(p\)</span> while some other countries export product <span class="math inline">\(p\)</span>, then a region that both imports and exports product <span class="math inline">\(p\)</span> is constructed.</li>
</ol>
<p>To run the <code><a href="../reference/transform_to_gma.html">transform_to_gma()</a></code> function, one can use the <code><a href="../reference/convert_to_net_trade.html">convert_to_net_trade()</a></code> function, which will calculate the difference between imported and exported products, and report traded products either as imports or as exports, depending on whether there are more imports than exports of product <span class="math inline">\(p\)</span> or not.</p>
<p>TO CHECK</p>
<ul>
<li>why the hell it is balanced when it shouldn’t be</li>
<li>why the heck does it work with a very odd product</li>
<li>why does it work when a country both imports and exports a product?</li>
</ul>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Emmanuel Aramendia.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
